/*创建FancyBBS数据库及需要的基本表*/


/***********************创建数据库******************************/
#删除可能存在的FancyBBS数据库
drop database if exists fancybbs;
#创建FancyBBS数据库
create database fancybbs;


/*************************创建FancyBBS数据库中的表******************/
#使用FancyBBS数据库
use fancybbs;

#删除可能存在的user表
drop table if exists user;
#创建user表
create table user(
 id int unsigned auto_increment primary key,
 account char(20) not null unique,
 password char(20) not null,
 nickName char(20) not null,
 email char(50),
 photo text,
 sex char(2),
 grade int not null,
 registrationdate date,
 point int default 50,
 blank_1 text,
 blank_2 text
);

#尝试插入user表一条数据admin超级用户
insert into user 
(account,password,nickname,email,photo,sex,grade,registrationdate,point) 
values(
 'admin',
 'admin',
 'admin',
 '751152833@qq.com',
 'img/UserPhoto/admin.jpg',
 '男',
 3,
 now(),
 9999
);

#删除可能存在的session表
drop table if exists session;
#创建session表
create table session(
 id int unsigned auto_increment primary key,
 name char(50) not null,
 masterId int unsigned,
 profile char(50) not null,
 topicCount int ,
 clickCount int,
 blank_1 text,
 blank_2 text,
 foreign key(masterId) references user(id) on delete cascade
);

#删除可能存在的topic表
drop table if exists topic;
#创建topic表
create table topic(
 id int unsigned auto_increment primary key,
 sId int unsigned,
 uId int unsigned,
 replyCount int,
 topic char(50) not null,
 contents text not null,
 time datetime,
 flag int default 0,
 clickCount int,
 lastReplyUseID int unsigned,
 lastReplayTime datetime,
 foreign key(uId) references user(id) on delete cascade,
 foreign key(sId) references session(id) on delete cascade,
 foreign key(lastReplyUseID) references user(id) on delete cascade
);

#删除可能存在的reply表
drop table if exists reply;
#创建reply表
create table reply(
 id int unsigned auto_increment primary key,
 tId int unsigned,
 uId int unsigned,
 content text,
 time datetime,
 foreign key(tId) references topic(id) on delete cascade,
 foreign key(uId) references user(id) on delete cascade
);

